(window.webpackJsonp=window.webpackJsonp||[]).push([[85],{1393:function(e,t,n){var content=n(1781);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(17).default)("090cd184",content,!0,{sourceMap:!1})},1394:function(e,t,n){var content=n(1783);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(17).default)("b8b06b72",content,!0,{sourceMap:!1})},1780:function(e,t,n){"use strict";var o=n(1393);n.n(o).a},1781:function(e,t,n){(e.exports=n(16)(!1)).push([e.i,"[v-cloak]{display:none}.el-tree--highlight-current .el-tree-node.is-current>.el-tree-node__content{background:rgba(32,160,255,.5)!important}.el-menu-item-group__title{padding:0}",""])},1782:function(e,t,n){"use strict";var o=n(1394);n.n(o).a},1783:function(e,t,n){(e.exports=n(16)(!1)).push([e.i,".el-main[data-v-9e27c6e6]{position:relative}.el-pagination[data-v-9e27c6e6]{position:fixed;bottom:19px}.tit[data-v-9e27c6e6]{border-bottom:1px solid #bfcbd9;margin:0;line-height:30px;padding:0 10px}.el-button-group[data-v-9e27c6e6],.r[data-v-9e27c6e6]{line-height:40px}.r[data-v-9e27c6e6]{overflow:hidden}.r span[data-v-9e27c6e6]{float:left}.r .el-radio-group[data-v-9e27c6e6]{float:right;line-height:40px}.r .addBtn[data-v-9e27c6e6]{margin:6px 0 0 10px;float:right}.zTree .el-tree-node__content[data-v-9e27c6e6]{background-color:red!important}.el-button--mini[data-v-9e27c6e6],.el-button--small[data-v-9e27c6e6]{padding:5px;margin:2px}.el-aside[data-v-9e27c6e6]{background-color:#fff;color:#333;border:1px solid #bfcbd9;margin:10px;height:calc(100vh - 141px)}.orgBox[data-v-9e27c6e6]{position:absolute;font-size:12px;color:grey;border:1px solid #ccc;text-align:center;padding:0;width:90px;background:#fff;z-index:2}.orgBox li[data-v-9e27c6e6]{line-height:23px;padding:5px 0;width:100%;cursor:pointer}.orgBox li a[data-v-9e27c6e6]{width:100%;display:inline-block;color:grey}.orgBox li[data-v-9e27c6e6] :hover{background:#eee}.closeBox[data-v-9e27c6e6]{width:100%;height:100%}.el-main[data-v-9e27c6e6]{background-color:#fff;color:#333;border:1px solid #bfcbd9;margin:10px;padding:0;height:calc(100vh - 141px)}",""])},1822:function(e,t,n){"use strict";n.r(t);n(222);var o=n(40),r=(n(133),n(33),n(76),n(6)),l=n(482),c=n.n(l);n(322),c.a.Random;r.a.isOnline||(c.a.mock(RegExp(r.a.ajaxUrl+"/upmsOrg/findUpmsOrgTree.*"),"post",function(){return{status:"OK",code:"success",message:"",data:[{orgName:"全部",parentCode:"-1",orgCode:"1",tenantId:"1",leaf:!1,orgId:"1"}],token:"",refreshToken:"",dataType:"json"}}),c.a.mock(RegExp(r.a.ajaxUrl+"/upmsUser/queryUserList.*"),"post",{status:"OK",code:"success",message:"",data:{"content|3-10":[{"userId|+1":"1",loginName:"@name",password:"Y13RNmw6TBE=",userName:"@cname",userSex:"0",userEmail:"@email",userPhone:/\d{11}/,createDate:"@date",userType:"0",userPhoto:"",status:"0","tenantId|+1":"1","orgCode|+1":"1",extendstr1:"",extendstr2:"",extendstr3:""}],last:!0,totalPages:1,totalElements:10,number:0,size:15,sort:[{direction:"DESC",property:"createDate",ignoreCase:!1,nullHandling:"NATIVE",ascending:!1,descending:!0}],first:!0,numberOfElements:1},token:"",refreshToken:"",dataType:"json"}));var d={data:function(){return{tenantId:"",orgCode:"",cloShow:!1,userStatus:"0",setFlag:!0,flag:!0,firstLevel:!1,menuVisible:!1,markFloat:1,iconClass:"el-icon-delete",iconCont:"已激活",orgObj:"",keys:[],node:"",pageNo:1,pageSize:15,total:0,islock:!0,props:{label:"orgName",children:"zones",isLeaf:"leaf"},defaultProps:{children:"children",label:"label"},tableData:[],tempTreeData:[]}},methods:{addUpdate:function(e,t,n){if("{}"==JSON.stringify(this.orgObj))this.$message({type:"warning",message:"请先选择组织机构!"});else{var o={};o=n?{orgObj:t,rowObj:n||null}:{orgObj:t},this.$router.push({name:e,params:o})}},handleEdit:function(e,t){console.log(e,t)},handleDelete:function(e,t){var n=this;this.$confirm("确认注销该用户吗?","提示信息",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var e={tenantId:n.tenantId,userIds:t.userId};r.a.post(r.a.ajaxUrl+"/upmsUser/deleteUser",e).then(function(e){"success"==e.data.code?(n.getUserList(0),n.$message({type:"success",message:"注销成功!"})):n.$message({type:"success",message:"注销失败!"})})}).catch(function(){n.$message({type:"info",message:"已取消删除"})})},handleNodeClick:function(data,e,t){this.tenantId=data.tenantId,this.orgCode=data.orgCode,this.orgObj=data,this.flag=!0,this.markFloat=e.id,this.keys=data.parentCode,1!=e.id?this.getUserList(this.userStatus):(this.orgCode="",this.getUserList(this.userStatus))},hanleContextmenu:function(e,t,n,o){this.menuVisible=!0,this.firstLevel=1!==n.level;var menu=document.querySelector("#menu");menu.style.left=e.clientX+20+"px",menu.style.top=e.clientY-60+"px",this.orgCode=t.orgCode,this.keys=t.parentCode,this.orgObj=t,this.node=n},removeTree:function(e,data){},orgDel:function(e,t){var n=this;this.$confirm("确认删除?","提示信息",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var e={tenantId:t.tenantId,orgId:t.orgId};r.a.post(r.a.ajaxUrl+"upmsOrg/deleteOrg",e).then(function(e){if("success"==e.data.code){for(var o=0,i=0;i<n.tempTreeData.length;i++)n.tempTreeData[i].tenantId==t.tenantId&&n.tempTreeData[i].orgId==t.orgId&&(o=i);n.tempTreeData.splice(o,1),n.$refs.tree.updateKeyChildren([n.keys],n.tempTreeData),n.$message({type:"success",message:"删除成功!"})}else n.$message({type:"success",message:"删除失败!"})})}).catch(function(e){n.$message({type:"info",message:"已取消删除"})})},closeBox:function(){this.menuVisible=!1},changeIcon:function(e,t){console.log(this.$refs.table),this.islock=!this.islock,this.islock?(this.iconClass="el-icon-delete",this.iconCont="已激活",t.status=0):(this.iconClass="el-icon-edit",this.iconCont="已锁定",t.status=1),this.$message({type:"success",message:"操作成功!"})},changeUser:function(label){this.setFlag=!this.setFlag,this.userStatus=label,this.pageNo=1,this.getUserList(label)},statusEve:function(e,t,n,o){return 0==e.status?"已激活":"待激活"},loadNode:function(){var e=Object(o.a)(regeneratorRuntime.mark(function e(t,n){var o,l,c=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=this,l={tenantId:0===t.level?"":t.data.tenantId,parentCode:0===t.level?-1:t.data.orgCode,userId:0},e.next=4,r.a.post(r.a.ajaxUrl+"/upmsOrg/findUpmsOrgTree",l).then(function(e){if("success"==e.data.code){if(!e.data)return;return o.tempTreeData=e.data.data,c.tenantId=e.data.data[0].tenantId,c.orgCode=e.data.data[0].orgCode,c.orgObj=e.data.data[0],n(o.tempTreeData)}c.$message({type:"error",message:e.data.message})}).catch(function(e){c.$message({type:"error",message:"加载失败"})});case 4:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),changePage:function(e){this.pageNo=e,this.getUserList(this.userStatus)},getUserList:function(e){var t=this,n={pageNum:this.pageNo,pageSize:this.pageSize,tenantId:this.tenantId,orgCode:this.orgCode,userStatus:e};return console.log("aaaa："+r.a.ajaxUrl),r.a.post(r.a.ajaxUrl+"/upmsUser/queryUserList",n).then(function(e){e.data&&(t.total=e.data.data.totalElements,t.tableData=e.data.data.content,t.listLoading=!1)})},testT:function(){this.$nextTick(function(){1==this.markFloat?(document.getElementsByClassName("el-tree-node")[0].classList.add("is-current"),this.orgCode="",this.getUserList(this.userStatus)):document.getElementsByClassName("el-tree-node")[0].classList.remove("is-current")})}},watch:{tempTreeData:function(e,t){e!=t&&this.testT()}}},m=(n(1780),n(1782),n(31)),component=Object(m.a)(d,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-container",[n("el-aside",{attrs:{width:"200px"}},[n("div",{staticClass:"closeBox",on:{click:function(t){return e.closeBox()}}},[n("p",{staticClass:"tit"},[e._v("组织机构")]),e._v(" "),n("el-tree",{ref:"tree",staticClass:"zTree",attrs:{props:e.props,load:e.loadNode,lazy:"","node-key":"orgCode",accordion:"","highlight-current":e.flag},on:{"node-click":e.handleNodeClick,"node-contextmenu":e.hanleContextmenu,remove:e.removeTree}}),e._v(" "),n("ul",{directives:[{name:"show",rawName:"v-show",value:e.menuVisible,expression:"menuVisible"}],ref:"menu",staticClass:"orgBox",attrs:{id:"menu"}},[n("li",[n("nuxt-link",{attrs:{to:{name:"authManagement-user-orgAdd",params:{orgObj:e.orgObj}}}},[e._v("添加")])],1),e._v(" "),n("li",{directives:[{name:"show",rawName:"v-show",value:e.firstLevel,expression:"firstLevel"}]},[n("nuxt-link",{attrs:{to:{name:"authManagement-user-orgEdit",params:{orgObj:e.orgObj}}}},[e._v("修改")])],1),e._v(" "),n("li",{directives:[{name:"show",rawName:"v-show",value:e.firstLevel,expression:"firstLevel"}],on:{click:function(t){return e.orgDel(e.node,e.orgObj)}}},[e._v("删除")])])],1)]),e._v(" "),n("el-main",[n("div",{staticClass:"tit r"},[n("span",[e._v("用户管理")]),e._v(" "),n("nuxt-link",{attrs:{to:{name:"authManagement-user-add",params:{orgObj:e.orgObj}}}},[n("el-button",{staticClass:"addBtn",attrs:{size:"mini",type:"primary",icon:"el-icon-plus"}},[e._v("新增用户")])],1),e._v(" "),n("el-radio-group",{attrs:{size:"mini"},on:{change:e.changeUser},model:{value:e.userStatus,callback:function(t){e.userStatus="string"==typeof t?t.trim():t},expression:"userStatus"}},[n("el-radio-button",{attrs:{label:"0"}},[e._v("活动用户")]),e._v(" "),n("el-radio-button",{attrs:{label:"1"}},[e._v("注销用户")])],1)],1),e._v(" "),n("el-table",{ref:"table",staticStyle:{width:"100%"},attrs:{data:e.tableData}},[n("el-table-column",{attrs:{label:"序号",type:"index"}}),e._v(" "),n("el-table-column",{attrs:{label:"姓名",prop:"userName"}}),e._v(" "),n("el-table-column",{attrs:{label:"用户名","show-overflow-tooltip":"",prop:"loginName"}}),e._v(" "),e.cloShow?n("el-table-column",{attrs:{label:"角色",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-popover",{attrs:{trigger:"hover",placement:"top"}},[n("p",[e._v("姓名: "+e._s(t.row.name))]),e._v(" "),n("p",[e._v("住址: "+e._s(t.row.address))]),e._v(" "),n("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[n("a",{attrs:{size:"medium"}},[e._v(e._s(t.row.name))])])])]}}],null,!1,3645692099)}):e._e(),e._v(" "),n("el-table-column",{attrs:{label:"状态",formatter:e.statusEve,prop:"status"}}),e._v(" "),n("el-table-column",{attrs:{"min-width":"100",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-tooltip",{attrs:{content:"编辑",placement:"bottom"}},[n("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-edit"},on:{click:function(n){return e.addUpdate("authManagement-organization-edit",e.orgObj,t.row)}}})],1),e._v(" "),n("el-tooltip",{directives:[{name:"show",rawName:"v-show",value:e.setFlag,expression:"setFlag"}],attrs:{content:"注销",placement:"bottom"}},[n("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(n){return n.stopPropagation(),e.handleDelete(t.$index,t.row)}}})],1),e._v(" "),n("el-tooltip",{directives:[{name:"show",rawName:"v-show",value:e.setFlag,expression:"setFlag"}],attrs:{content:e.iconCont,placement:"bottom"}},[n("el-button",{attrs:{size:"mini",type:"info",icon:0==t.row.status?"el-icon-unlock":"el-icon-lock"},on:{click:function(n){return n.stopPropagation(),e.changeIcon(t.$index,t.row)}}})],1),e._v(" "),n("el-tooltip",{directives:[{name:"show",rawName:"v-show",value:e.setFlag,expression:"setFlag"}],attrs:{content:"重置",placement:"bottom"}},[n("el-button",{attrs:{size:"mini",type:"warning",icon:"el-icon-minus-circle"}})],1),e._v(" "),n("el-tooltip",{directives:[{name:"show",rawName:"v-show",value:e.setFlag,expression:"setFlag"}],attrs:{content:"角色配置",placement:"bottom"}},[n("el-button",{attrs:{size:"mini",type:"success",icon:"el-icon-setting"}})],1),e._v(" "),n("el-tooltip",{directives:[{name:"show",rawName:"v-show",value:!e.setFlag,expression:"!setFlag"}],attrs:{content:"还原",placement:"bottom"}},[n("el-button",{attrs:{size:"mini",type:"warning",icon:"el-icon-delete"}})],1)]}}])})],1),e._v(" "),n("el-pagination",{attrs:{small:"",layout:"prev, pager, next","current-page":e.pageNo,"page-size":e.pageSize,total:e.total},on:{"current-change":e.changePage}})],1)],1)],1)},[],!1,null,"9e27c6e6",null);t.default=component.exports}}]);