(window.webpackJsonp=window.webpackJsonp||[]).push([[83],{1391:function(e,r,t){var content=t(1777);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,t(17).default)("489ae9af",content,!0,{sourceMap:!1})},1776:function(e,r,t){"use strict";var o=t(1391);t.n(o).a},1777:function(e,r,t){(e.exports=t(16)(!1)).push([e.i,"$color:#409eff;.el-form-item .el-input__inner[data-v-4ab55692]{max-width:300px;width:300px}#userAdd[data-v-4ab55692],#userEdit[data-v-4ab55692]{margin-top:30px;border:1px solid #eee;padding:20px;.el-upload__tip{margin-left:10px}.sub{margin-top:20px}//用户头像上传 .avatar-uploader .el-upload{border:1px dashed #d9d9d9;border-radius:6px;cursor:pointer;position:relative;overflow:hidden}.avatar-uploader .el-upload:hover{border-color:#409eff}.avatar-uploader-icon{font-size:28px;color:#8c939d;width:78px;height:78px;line-height:78px;text-align:center;border:1px solid #eee}.avatar{width:78px;height:78px;display:block}}.content-wrapper[data-v-4ab55692]{background-color:#fff;box-sizing:border-box}.avatar-uploader .el-upload[data-v-4ab55692]{border:1px dashed #d9d9d9;border-radius:6px;cursor:pointer;position:relative;overflow:hidden}.avatar-uploader .el-upload[data-v-4ab55692]:hover{border-color:#409eff}.avatar-uploader-icon[data-v-4ab55692]{font-size:28px;color:#8c939d;width:78px;height:78px;line-height:78px;text-align:center;border:1px solid #eee}.avatar[data-v-4ab55692]{width:78px;height:78px;display:block}",""])},1837:function(e,r,t){"use strict";t.r(r);t(76);var o=t(6),l=t(482),n=t.n(l),m=(n.a.Random,function(){return{status:"OK",code:"success"}});o.a.isOnline||(n.a.mock(RegExp(o.a.ajaxUrl+"/upmsUser/checkUserLoginName.*"),"post",m),n.a.mock(RegExp(o.a.ajaxUrl+"/upmsUser/addUser.*"),"post",m));var c={data:function(){var e=this;return{orgCode:"1",form:{loginName:"",pass:"",checkPass:"",userName:"",userSex:1,email:"",phone:"",userType:""},rules:{loginName:[{validator:function(e,r,t){if(r)if(/^[a-zA-Z][a-zA-Z0-9_]{4,15}$/.test(r)){var l={tenantId:o.a.auth.tenantId,loginName:r,checkType:"loginName"};o.a.post(o.a.ajaxUrl+"/upmsUser/checkUserLoginName",l).then(function(e){"error"===(e=e.data).code?t(new Error(e.message)):t(),e.refreshToken&&(o.a.refreshToken=e.refreshToken)})}else t(new Error("用户名应为以字母开头，长度在6~18的字母、数字和下划线"));else t(new Error("用户名不能为空"))},trigger:"blur",required:!0}],pass:[{validator:function(r,t,o){""===t?o(new Error("请输入密码")):/^[a-zA-Z]\w{5,17}$/.test(t)?(""!==e.form.checkPass&&e.$refs.form.validateField("checkPass"),o()):o(new Error("密码应为以字母开头，长度在6~18的字母、数字和下划线"))},trigger:"blur",required:!0}],checkPass:[{validator:function(r,t,o){""===t?o(new Error("请再次输入密码")):t!==e.form.pass?o(new Error("两次输入密码不一致!")):o()},trigger:"blur",required:!0}],email:[{validator:function(e,r,t){/^[a-zA-Z0-9_-]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/.test(r)||""==r?t():t(new Error("邮箱格式错误"))},trigger:"blur",required:!1}],userName:[{validator:function(e,r,t){/^[\u4E00-\u9FA5A-Za-z]+$/.test(r)||""==r?t():t(new Error("只能输入中文和英文"))},trigger:"blur"}],phone:[{validator:function(e,r,t){/^(13[0-9]|14[5|7]|15[0|1|2|3|5|6|7|8|9]|18[0|1|2|3|5|6|7|8|9])\d{8}$/.test(r)||""==r?t():t(new Error("手机号错误"))},trigger:"blur"}],userType:[{validator:function(e,r,t){r?t():t(new Error("请选择用户类型"))},required:!0}]},imageUrl:"",msg:"",errTip:"",actionUrl:o.a.ajaxUrl+"upmsUser/uploadUserPhoto"}},methods:{formatSex:function(e,r){return 1==e.userSex?"男":0==e.userSex?"女":"未知"},onSubmit:function(e){var r=this,t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;var l={loginName:r.form.loginName,password:r.form.pass,userName:r.form.userName,userSex:r.form.userSex,userEmail:r.form.email,userPhone:r.form.phone,userType:r.form.userType,userPhoto:r.imageUrl,tenantId:r.$route.params.orgObj.tenantId,orgCode:r.$route.params.orgObj.orgCode};o.a.post(o.a.ajaxUrl+"/upmsUser/addUser",l).then(function(e){"success"==e.data.code?(r.$message({message:"添加成功",type:"success"}),t.$router.push({path:"/authManagement/user/list"})):r.$message({message:"添加失败",type:"error"})})})},handleAvatarSuccess:function(e,r){this.errTip=!1,this.imageUrl=URL.createObjectURL(r.raw)},handleAvatarError:function(e,r,t){this.errTip=!0,this.msg="上传头像失败"},beforeAvatarUpload:function(e){var r="image/jpeg"===e.type,t=e.size/1024/1024<2;return r||(this.errTip=!0,this.msg="上传头像图片只能是 JPG 格式!"),t||(this.errTip=!0,this.msg="上传头像图片大小不能超过 2MB!"),r&&t}},mounted:function(){this.$route.params.orgObj||this.$router.push({path:"/authManagement/user/list"}),console.log(this.$route)}},d=(t(1776),t(31)),component=Object(d.a)(c,function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{attrs:{id:"userAdd"}},[t("el-form",{ref:"form",attrs:{rules:e.rules,model:e.form,size:"mini","status-icon":"","label-width":"80px"}},[t("nuxt-link",{attrs:{tag:"a",to:"/authManagement/user/list"}},[t("i",{staticClass:"el-icon-back"})]),e._v(" "),t("el-form-item",{attrs:{label:"用户名",prop:"loginName"}},[t("el-input",{staticStyle:{"max-width":"300px"},attrs:{clearable:"",type:"text","auto-complete":"off"},model:{value:e.form.loginName,callback:function(r){e.$set(e.form,"loginName","string"==typeof r?r.trim():r)},expression:"form.loginName"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"密码",prop:"pass"}},[t("el-input",{staticStyle:{"max-width":"300px"},attrs:{clearable:"",type:"password","auto-complete":"off"},model:{value:e.form.pass,callback:function(r){e.$set(e.form,"pass","string"==typeof r?r.trim():r)},expression:"form.pass"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"确认密码",prop:"checkPass"}},[t("el-input",{staticStyle:{"max-width":"300px"},attrs:{clearable:"",type:"password","auto-complete":"off"},model:{value:e.form.checkPass,callback:function(r){e.$set(e.form,"checkPass","string"==typeof r?r.trim():r)},expression:"form.checkPass"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"姓名",prop:"userName"}},[t("el-input",{staticStyle:{"max-width":"300px"},attrs:{clearable:"",type:"text","auto-complete":"off"},model:{value:e.form.userName,callback:function(r){e.$set(e.form,"userName","string"==typeof r?r.trim():r)},expression:"form.userName"}})],1),e._v(" "),t("el-form-item",{attrs:{prop:"userSex",label:"性别"}},[t("el-radio-group",{model:{value:e.form.userSex,callback:function(r){e.$set(e.form,"userSex","string"==typeof r?r.trim():r)},expression:"form.userSex"}},[t("el-radio",{staticClass:"radio",attrs:{label:1}},[e._v("男")]),e._v(" "),t("el-radio",{staticClass:"radio",attrs:{label:0}},[e._v("女")])],1)],1),e._v(" "),t("el-form-item",{attrs:{prop:"phone",label:"移动电话"}},[t("el-input",{staticStyle:{"max-width":"300px"},attrs:{clearable:""},model:{value:e.form.phone,callback:function(r){e.$set(e.form,"phone","string"==typeof r?r.trim():r)},expression:"form.phone"}})],1),e._v(" "),t("el-form-item",{attrs:{prop:"email",label:"邮箱"}},[t("el-input",{staticStyle:{"max-width":"300px"},attrs:{clearable:"",type:"text","auto-complete":"off"},model:{value:e.form.email,callback:function(r){e.$set(e.form,"email","string"==typeof r?r.trim():r)},expression:"form.email"}})],1),e._v(" "),t("el-form-item",{attrs:{prop:"userType",label:"用户类型"}},[t("el-select",{attrs:{placeholder:"请选择用户类型"},model:{value:e.form.userType,callback:function(r){e.$set(e.form,"userType","string"==typeof r?r.trim():r)},expression:"form.userType"}},[t("el-option",{attrs:{label:"超级管理员",value:"0"}}),e._v(" "),t("el-option",{attrs:{label:"管理员",value:"1"}}),e._v(" "),t("el-option",{attrs:{label:"普通用户",value:"2"}})],1)],1),e._v(" "),t("el-form-item",{attrs:{prop:"",label:"上传头像"}},[t("el-upload",{staticClass:"avatar-uploader",attrs:{action:e.actionUrl,"show-file-list":!1,"on-success":e.handleAvatarSuccess,"on-error":e.handleAvatarError,"before-upload":e.beforeAvatarUpload}},[e.imageUrl?t("img",{staticClass:"avatar",attrs:{src:e.imageUrl}}):t("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.errTip,expression:"errTip"}],staticClass:"el-upload__tip",staticStyle:{color:"red"}},[e._v(e._s(e.msg))])],1),e._v(" "),t("el-form-item",{staticClass:"sub"},[t("el-button",{attrs:{type:"primary"},on:{click:function(r){return e.onSubmit("form")}}},[e._v("确定")]),e._v(" "),t("el-button",[e._v("取消")])],1)],1)],1)},[],!1,null,"4ab55692",null);r.default=component.exports}}]);