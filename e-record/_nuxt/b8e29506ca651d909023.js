(window.webpackJsonp=window.webpackJsonp||[]).push([[55],{1183:function(e,t,n){var content=n(1343);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(17).default)("48d4d70f",content,!0,{sourceMap:!1})},1342:function(e,t,n){"use strict";var o=n(1183);n.n(o).a},1343:function(e,t,n){(e.exports=n(16)(!1)).push([e.i,".upload-content-wrapper[data-v-48cf314f]{height:calc(100vh - 165px);overflow-x:hidden;overflow-y:auto}.upload-content[data-v-48cf314f]{height:auto;width:100%;background:#fff;text-align:left;padding:5px 0;overflow-y:auto}.upload-content .upload-content-from[data-v-48cf314f]{width:450px}.upload-content .upload-content-from .el-upload-list[data-v-48cf314f]{width:410px}.upload-content .upload-content-from .el-form--label-top .el-form-item__label[data-v-48cf314f]{padding:0}",""])},1418:function(e,t,n){"use strict";n.r(t);n(50);var o=n(6),l={data:function(){return{labelPosition:"top",form:{fileList:[]},dialogFormVisible:!1,showFileFlag:!0,uploadData:"",unitId:"",facilitiesInData:null,limtShow:!1,fullscreenLoading:!1}},created:function(){},mounted:function(){this.unitId=localStorage.getItem("unitId"),this.facilitiesInData=this._Storage.getObj("fileItem","obj"),0==this.facilitiesInData.limtShow&&(this.limtShow=!0),this.findFileAll(this.unitId)},methods:{handleAvatarProgress:function(){this.fullscreenLoading=!0},yjClear:function(){var e=this;this.$confirm("确定要一键删除图纸吗?","下载提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){o.a.get("/remoteApi/tool/record/withdrawPictureByUnitId?unitId="+e.unitId).then(function(t){"success"===t.code?(e.form.fileList=[],e.findFileAll(e.unitId)):(e.findFileAll(e.unitId),e.$message({type:"warning",message:"一键删除失败"}))}).catch(function(t){e.$message({type:"warning",message:"删除失败"})})}).catch(function(t){e.$message({type:"warning",message:"取消一键删除!"})})},yjDownload:function(){var e=this;this.$confirm("确定要一键下载图纸吗?","下载提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){window.open("/remoteApi/tool/record/downloadPictureZip?unitId="+e.unitId)}).catch(function(t){e.$message({type:"warning",message:"取消下载!"})})},findFileAll:function(e){var t=this,n=this;o.a.get("/remoteApi/tool/record/findFinishPicturePath?unitId="+e).then(function(e){if("success"===e.code){if(!(e.data instanceof Array))return;n.form.fileList=e.data}else t.$message({type:"warning",message:e.rspMsg||e.message})}).catch(function(e){t.$message({type:"warning",message:e})})},handleRemove:function(e,t){var n=this,l=this;e.url&&o.a.get("/remoteApi/tool/record/withdrawAttachment?url="+e.url).then(function(e){"success"===e.code?(l.form.fileList=[],l.findFileAll(l.unitId)):(l.findFileAll(l.unitId),n.$message({type:"warning",message:"删除失败"}))}).catch(function(e){n.$message({type:"warning",message:"删除失败"})})},handleAvatarError:function(e,t,n){this.fullscreenLoading=!1,this.$message({message:"上传文件失败失败",type:"error"})},handleAvatarSuccess:function(e,t){"success"==e.code?((e.data=this.unitId)?(this.form.fileList=[],this.findFileAll(this.unitId)):(this.findFileAll(this.unitId),this.$message({type:"warning",message:" 上传文件夹名称不匹配"})),this.showFileFlag=!0,this.fullscreenLoading=!1):(this.fullscreenLoading=!1,this.findFileAll(this.unitId),this.$message({message:e.message,type:"error"}),this.showFileFlag=!1)},beforeAvatarUpload:function(e){return".zip"!=e.name.substring(e.name.length-4)?(this.$message.error("文件格式请传zip"),!1):this.unitId!=e.name.slice(0,-4)?(this.$message.error("文件名和单位名称不匹配"),!1):void 0}}},r=(n(1342),n(31)),component=Object(r.a)(l,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"upload-content-wrapper"},[n("div",{staticClass:"upload-content"},[n("div",{staticStyle:{"padding-left":"20px"}},[n("el-form",{ref:"form",staticClass:"upload-content-from",attrs:{model:e.form,"label-position":e.labelPosition,"label-width":"100px"}},[e.form.fileList.length>0?n("el-form-item",[n("el-button",{attrs:{type:"primary",disabled:e.limtShow,icon:"el-icon-delete"},on:{click:e.yjClear}},[e._v("一键清除图纸")]),e._v(" "),n("el-button",{attrs:{type:"success",icon:"el-icon-download"},on:{click:e.yjDownload}},[e._v("一键下载图纸")])],1):e._e(),e._v(" "),n("el-form-item",{attrs:{label:"上传文件:"}},[n("el-upload",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.fullscreenLoading,expression:"fullscreenLoading",modifiers:{fullscreen:!0,lock:!0}}],ref:"upload",staticClass:"upload-demo",attrs:{disabled:e.limtShow,data:{unitId:e.unitId},drag:"",action:"/remoteApi/tool/record/uploadFinishFile",accept:"multipart/form-data","on-remove":e.handleRemove,"file-list":e.form.fileList,"on-error":e.handleAvatarError,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload,"on-progress":e.handleAvatarProgress,"auto-upload":!0,"show-file-list":e.showFileFlag,multiple:""}},[n("i",{staticClass:"el-icon-upload"}),e._v(" "),n("div",{staticClass:"el-upload__text"},[e._v("在此处上传文件"),n("em",[e._v("点击上传")])])])],1)],1)],1)])])},[],!1,null,"48cf314f",null);t.default=component.exports}}]);